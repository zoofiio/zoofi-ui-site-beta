"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5974],{95702:function(e,t,a){a.d(t,{c:function(){return CoinIcon}});var n=a(31113),u=a(26758);let o={iBGT:"webp","HONEY-WBERA":"webp"};function CoinIcon(e){let{symbol:t,size:a=48,...r}=e,s=t in o?o[t]:"svg",l="".concat(u.G,"/").concat(t,".").concat(s);return(0,n.jsx)("img",{...r,width:a,height:a,src:l,alt:t})}},26758:function(e,t,a){a.d(t,{G:function(){return u}});var n=a(28070);let u=n.env.NEXT_PUBLIC_BASE_PATH||""},22139:function(e,t,a){a.d(t,{Hj:function(){return o},Pq:function(){return r},SH:function(){return s},Vi:function(){return c},_u:function(){return i},pn:function(){return l},v:function(){return u},xb:function(){return DOC_LINK}});var n=a(44769);let u="https://x.com/ZooFinanceIO",o="https://t.co/RJwdwdawe5",r=BigInt(1e18),s=BigInt("31536000"),l=864e5,DOC_LINK=()=>"https://docs.".concat(n.Kh.value),c="beta",i="beta"==c},44769:function(e,t,a){a.d(t,{Kh:function(){return u},Vi:function(){return useConfigDomain}});var n=a(64103);let u={value:"zoofi.io"},o=["zoofi.io","zoofi.xyz"],getAvilableDomain=()=>{var e;if("localhost"==location.hostname||(null===(e=location.hostname.match(/^\d+\.\d+\.\d+\.\d+$/))||void 0===e?void 0:e.length)==1)return o[0];let t=location.hostname.split("."),a=t.slice(-2).join(".");return("ipns"==t[1]&&(a=t[0].replaceAll("-",".")),o.includes(a))?a:o[0]};function useConfigDomain(){(0,n.useEffect)(()=>{u.value=getAvilableDomain()},[])}},18358:function(e,t,a){a.d(t,{ES:function(){return useUpdateUserBVaultData},Og:function(){return v},T:function(){return useUpdateUserBVaultEpoches},Vw:function(){return useEpochesData},__:function(){return useBVaultData},d6:function(){return useResetBVaultsData},gz:function(){return useCalcClaimable},oU:function(){return useBVaultApy},og:function(){return useUpdateBVaultEpoches},qv:function(){return useUpdateBVaultsData},v7:function(){return useBVaultBoost},zz:function(){return useBVaultsDataShallow}});var n=a(73417),u=a(22139),o=a(59175),r=a(23647),s=a(26361),l=a(84944),c=a(64370),i=a(64103),d=a(58714),p=a(62531),f=a(96670),m=a(93108),h=a(25300);async function getBVaultData(e,t){let a=await e.readContract({abi:n.j5,address:t.vault,functionName:"epochIdCount"});return Promise.all([e.readContract({abi:d.Wo,address:t.pToken,functionName:"totalSupply"}),e.readContract({abi:n.j5,address:t.vault,functionName:"assetBalance"}),e.readContract({abi:n.j5,address:t.vault,functionName:"paramValue",args:[(0,p.$G)("f2",{size:32})]}),a&&"0xF778D2B9E0238D385008e916D7245F51959Ba279"!==t.vault?e.readContract({abi:n.j5,address:t.vault,functionName:"Y"}):Promise.resolve(0n),a?e.readContract({abi:n.j5,address:t.vault,functionName:"yTokenTotalSupply",args:[a]}):0n,a?e.readContract({abi:n.j5,address:t.vault,functionName:"yTokenTotalSupplySynthetic",args:[a]}):0n,a?e.readContract({abi:n.j5,address:t.vault,functionName:"yTokenUserBalance",args:[a,t.vault]}):0n]).then(e=>{let[n,u,o,r,l,c,i]=e;return{epochCount:a,pTokenTotal:n,vault:t.vault,lockedAssetTotal:u,f2:o,Y:r,yTokenTotalSupply:l,yTokenTotalSupplySynthetic:c,assetAmountForSwapYT:(0,s.aE)(n-l,o),yTokenAmountForSwapYT:l-i}})}async function getBVaultEpochData(e,t,a){let getRedeemPoolData=async t=>{let a=await e.readContract({abi:n.gg,address:t,functionName:"settled"});return{settled:a}},[u,o,r,s]=await Promise.all([e.readContract({abi:n.j5,address:t.vault,functionName:"epochInfoById",args:[a]}).then(e=>getRedeemPoolData(e.redeemPool).then(t=>({...e,...t}))),e.readContract({abi:n.j5,address:t.vault,functionName:"yTokenTotalSupply",args:[a]}),e.readContract({abi:n.j5,address:t.vault,functionName:"yTokenTotalSupplySynthetic",args:[a]}),e.readContract({abi:n.j5,address:t.vault,functionName:"yTokenUserBalance",args:[a,t.vault]})]);return{...u,yTokenTotal:o,yTokenTotalSupplySynthetic:r,vaultYTokenBalance:s}}let defBvaults=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.Yb)(e,e=>(0,s.Yb)({vault:e,epochCount:0n,pTokenTotal:0n,lockedAssetTotal:0n,f2:0n,Y:0n,yTokenTotalSupply:0n,yTokenTotalSupplySynthetic:0n,assetAmountForSwapYT:0n,yTokenAmountForSwapYT:0n},0n))},defUserBvaults=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.Yb)(e,e=>(0,s.Yb)({vault:e,userBalanceAssset:0n,userBalancePToken:0n,redeemingBalance:0n},0n))},defEpoches=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.Yb)(e,[])},v=(0,m.Ue)((e,t)=>({isLoading:!1,bvaults:defBvaults(),userBvaults:defUserBvaults(),epochs:defEpoches(),userEpochs:defEpoches(),updateBVaults:async a=>{console.info("updateBVaults",a);let n=r.bv.getState().pc,u=await Promise.all(a.map(e=>getBVaultData(n,e))),o={...t().bvaults};return u.forEach(e=>o[e.vault]=e),e({bvaults:defBvaults(o)}),u},updateUserBVaults:async(a,u)=>{console.info("updateUserBVaults",a,u);let o=r.bv.getState().pc,s=await Promise.all(a.map(e=>{let a=t().bvaults[e.vault];return Promise.all([o.readContract({abi:d.Wo,address:e.asset,functionName:"balanceOf",args:[u]}),o.readContract({abi:d.Wo,address:e.pToken,functionName:"balanceOf",args:[u]}),a.epochCount?o.readContract({abi:n.j5,address:e.vault,functionName:"epochInfoById",args:[a.epochCount]}).then(e=>o.readContract({abi:n.gg,address:e.redeemPool,functionName:"settled"}).then(t=>({epoch:e,settled:t}))).then(e=>{let{epoch:t,settled:a}=e;return a?0n:o.readContract({abi:n.gg,address:t.redeemPool,functionName:"userRedeemingBalance",args:[u]})}):Promise.resolve(0n)]).then(t=>{let[a,n,u]=t;return{userBalanceAssset:a,userBalancePToken:n,vault:e.vault,redeemingBalance:u}})})),l={...t().userBvaults};return s.forEach(e=>l[e.vault]=e),console.info("setUserBvaults:",l),e({userBvaults:defUserBvaults(l)}),s},updateEpoches:async(a,n)=>{console.info("updateEpoches",a,n);let u=r.bv.getState().pc,o=Array(parseInt(n.epochCount.toString())).fill(0).map((e,t)=>n.epochCount-BigInt(t)),s=await (n.epochCount>0n?Promise.all(o.map(e=>getBVaultEpochData(u,a,e))):Promise.resolve([]));return e({epochs:defEpoches({...t().epochs,[a.vault]:s})}),s},updateUserEpoches:async(a,u,o)=>{console.info("updateUserEpoches",a,u,o);let s=r.bv.getState().pc,getRedeemPoolData=(e,t)=>Promise.all([t.settled?Promise.resolve(0n):s.readContract({abi:n.gg,address:e,functionName:"userRedeemingBalance",args:[o]}),s.readContract({abi:n.gg,address:e,functionName:"earnedAssetAmount",args:[o]})]).then(e=>{let[t,a]=e;return{redeemingBalance:t,claimableAssetBalance:a}}),getBribe=async(e,t)=>{let u=await s.readContract({abi:n.j5,address:a.vault,functionName:"bribeTotalAmount",args:[e,t.bribeToken]}),o=await s.readContract({abi:d.Wo,address:t.bribeToken,functionName:"symbol"});return{...t,totalRewards:u,bribeSymbol:o}},getBribes=async e=>{let t=await s.readContract({abi:n.j5,address:a.vault,functionName:"calcBribes",args:[e,o]});return Promise.all(t.map(t=>getBribe(e,t)))},l=await Promise.all(u.map(e=>Promise.all([getBribes(e.epochId),getRedeemPoolData(e.redeemPool,e),s.readContract({abi:n.j5,address:a.vault,functionName:"yTokenUserBalance",args:[e.epochId,o]}),s.readContract({abi:n.j5,address:a.vault,functionName:"yTokenUserBalanceSynthetic",args:[e.epochId,o]})]).then(t=>{let[a,n,u,o]=t;return{epochId:e.epochId,bribes:a,...n,userBalanceYToken:u,userBalanceYTokenSyntyetic:o}})));return e({userEpochs:defEpoches({...t().userEpochs,[a.vault]:l})}),l}}));function useBVaultsDataShallow(e){return v((0,h.N)(e))}function useBVaultData(e){let t="string"==typeof e?e:e.vault;return useBVaultsDataShallow(e=>e.bvaults[t])}function useUpdateBVaultsData(e){return(0,c.a)({queryFn:()=>v.getState().updateBVaults(e),queryKey:[e]})}function useResetBVaultsData(){let e=(0,o.p)(),{address:t}=(0,f.m)();(0,i.useEffect)(()=>{v.setState({bvaults:defBvaults(),userBvaults:defUserBvaults(),epochs:defEpoches(),userEpochs:defEpoches()})},[e]),(0,i.useEffect)(()=>{v.setState({userBvaults:defUserBvaults(),userEpochs:defEpoches()})},[t])}function useUpdateUserBVaultData(e){let{address:t}=(0,f.m)(),a=useBVaultData(e);return(0,c.a)({queryKey:[t,e,a],enabled:!!t,queryFn:()=>v.getState().updateUserBVaults([e],t)})}function useUpdateBVaultEpoches(e){let t=useBVaultData(e);return(0,c.a)({queryKey:[e,t],enabled:t.epochCount>0n,queryFn:()=>v.getState().updateEpoches(e,t)})}function useUpdateUserBVaultEpoches(e){let t=useBVaultsDataShallow(t=>t.epochs[e.vault]),{address:a}=(0,f.m)();return(0,c.a)({queryKey:[e,t,a],enabled:t.length>0&&!!a,queryFn:()=>v.getState().updateUserEpoches(e,t,a)})}function useEpochesData(e){let{epochs:t,userEpochs:a}=useBVaultsDataShallow(e=>{let{epochs:t,userEpochs:a}=e;return{epochs:t,userEpochs:a}});return(0,i.useMemo)(()=>t[e].map(t=>(0,s.Yb)({...t,...a[e].find(e=>e.epochId==t.epochId)||{bribes:[]}},0n)),[t,a])}function useCalcClaimable(e){let t=useEpochesData(e);return(0,i.useMemo)(()=>{let e=t.filter(e=>e.claimableAssetBalance&&e.settled);return{ids:e.map(e=>e.epochId),claimable:e.reduce((e,t)=>e+t.claimableAssetBalance,0n)}},[t])}function useBVaultBoost(e){let t=useBVaultData(e),a=t.assetAmountForSwapYT>0n?100n*t.lockedAssetTotal/t.assetAmountForSwapYT:100000n;return[(0,l.d)(a,0,2),a]}function useBVaultApy(e){let t=useBVaultData(e),a=t.yTokenTotalSupplySynthetic>0n?t.assetAmountForSwapYT*u.SH*BigInt(1e10)/t.yTokenTotalSupplySynthetic:0n;return[(0,s.Jh)(a,10),a]}},84944:function(e,t,a){a.d(t,{d:function(){return displayBalance}});var n=a(35057);let displayBalance=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:18;if(!e)return"0";let fmtNumber=e=>e.toLocaleString("en-US",{maximumFractionDigits:t}),u=Number((0,n.b)(e,a)),o=Number((.1**t).toFixed(t));return u>0&&u<o?u<.001?fmtNumber(1e6*u)+"Î¼":"<"+o:u<0&&u>-o?"â‰ˆ0":fmtNumber(u)}}}]);