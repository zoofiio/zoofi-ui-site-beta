(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{32004:function(e,t,a){Promise.resolve().then(a.bind(a,10219))},10219:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return AdminPage}});var r=a(31113),s=a(99548),n=a(44939),l=a(63244),i=a(87031),o=a(19757),u=a(59175),c=a(15506),d=a(33501),p=a(64103),m=a(23125),b=a(83960),f=a(45631),x=a(58409),v=a(62531),g=a(35057),h=a(33737),A=a(11292),y=a(41440);let j={menu:()=>"bg-white dark:bg-black dark:border",control:()=>"bg-white dark:bg-black",singleValue:()=>"dark:text-white"},w=[{label:"资产利息率",value:"Y"},{label:"目标AAR",value:"AART"},{label:"安全AAR",value:"AARS"},{label:"上顶AAR",value:"AARU"},{label:"熔断AAR",value:"AARC"},{label:"赎回手续费",value:"C"},{label:"进入国库比例",value:"TreasuryFeeRate"},{label:"Discount冷静时间",value:"CircuitBreakPeriod",units:0},{label:"低买池最小成交量USB",value:"PtyPoolMinUsbAmount"},{label:"高卖池最小成交量",value:"PtyPoolMinAssetAmount"},{label:"RateR",value:"RateR"}],N=[{label:"产品周期",value:"D",units:0},{label:"初始定价",value:"APRi"},{label:"保底定价",value:"APRl"},{label:"衰减时长",value:"T",units:0},{label:"价格变动系数",value:"e1",units:0},{label:"斜率变动系数",value:"e2",units:0},{label:"赎回手续费",value:"f1"},{label:"利息佣金",value:"f2"}];function Expandable(e){let{children:t,tit:a,disable:s}=e,[n,l]=(0,p.useState)(!1);return(0,r.jsxs)("div",{className:"flex flex-col w-full bg-white dark:bg-transparent rounded-2xl overflow-hidden border border-solid border-blue-400",children:[(0,r.jsxs)("div",{className:"px-5 py-2 flex justify-between items-center text-sm",children:[(0,r.jsx)("div",{className:"font-medium text-base",children:a}),s?t:(0,r.jsxs)("div",{className:"px-2 py-1 rounded-full border border-solid border-primary flex items-center text-xs text-primary cursor-pointer ",onClick:()=>l(!n),children:[(0,r.jsx)("span",{className:"mr-[5px]",children:n?"Close":"Expand"}),n?(0,r.jsx)(b.iRh,{}):(0,r.jsx)(b.tv1,{})]})]}),(0,r.jsx)(m.Collapse,{isOpened:n,theme:{content:"bg-gray-200 dark:bg-transparent p-4 flex flex-col gap-2"},children:t})]})}function UpdateVaultParams(e){let{paramList:t,vault:a,protocoSettingAddress:n}=e,i=(0,p.useMemo)(()=>t.map(e=>({...e,label:"".concat(e.label,"(").concat(e.value,")")})),[t]),[{value:o,param:u},m]=(0,x.Z)({value:"",param:i[0]}),{data:b}=(0,c.uX)({contracts:t.map(e=>({abi:l.$4,address:n,functionName:"vaultParamValue",args:[a,(0,v.$G)(e.value,{size:32})]}))}),A=(0,p.useMemo)(()=>(b||[]).map((e,a)=>{let r=t[a];return"".concat(r.label,"(").concat(r.value,"): ").concat((0,g.b)(e.result||0n,"number"==typeof r.units?r.units:10))}),[b]),y="number"==typeof u.units?u.units:10;return(0,r.jsxs)(Expandable,{tit:"Vault Param Vaule",children:[(0,r.jsx)(f.ZP,{classNames:j,maxMenuHeight:340,value:u,options:i,onChange:e=>m({param:e})}),(0,r.jsx)("input",{value:o.toString(),onChange:e=>{let t=(e.target.value||"").replaceAll("-","").replaceAll("+","");m({value:t})},type:"number",className:(0,d.Z)("bg-white dark:bg-transparent border-slate-400  focus:border-blue-400 ","w-full h-14 text-right pr-4 font-bold text-sm border focus:border-2 rounded-md outline-none"),pattern:"[0-9.]{36}",step:1,placeholder:"0"}),(0,r.jsx)(s.v,{tx:"Write",config:{abi:l.$4,address:n,functionName:"updateVaultParamValue",args:[a,(0,v.$G)(u.value,{size:32}),(0,h.v)(o,y)]},onTxSuccess:()=>{m({value:""})},className:"btn-primary flex items-center justify-center gap-4"}),(0,r.jsx)("div",{className:"text-sm flex flex-col items-start",children:A.map((e,t)=>(0,r.jsx)("div",{children:e},"info_".concat(t)))})]})}function UpdateVaultPrice(e){let{vc:t}=e,[{feed:a},n]=(0,x.Z)({feed:""});return(0,r.jsxs)(Expandable,{tit:"Vault Price Feed",children:[(0,r.jsx)("input",{type:"text",placeholder:"_assetTokenPriceFeed_",value:a,onChange:e=>n({feed:e.target.value}),className:(0,d.Z)("bg-white dark:bg-transparent border-slate-400  focus:border-blue-400 ","w-full h-14 text-right pr-4 font-bold text-sm border focus:border-2  rounded-md outline-none")}),(0,r.jsx)(s.v,{tx:"Write",config:{abi:l.WW,address:t.vault,functionName:"updatePriceFeed",args:[a]},onTxSuccess:()=>{n({feed:""})},className:"btn-primary flex items-center justify-center gap-4"})]})}let convertArgs=(e,t)=>e.map((e,a)=>{let r=t[a];return r.type.startsWith("uint")?BigInt(e):"bytes32"==r.type?(0,v.$G)(e,{size:32}):e});function GeneralAction(e){var t;let{abi:a,address:n,functionName:l,tit:i}=e,o=a.find(e=>"function"==e.type&&e.name==l),[{args:u},c]=(0,x.Z)({args:Array(o.inputs.length).fill("")});if(o)return(0,r.jsxs)(Expandable,{tit:i||l,disable:!o.inputs||0==o.inputs.length,children:[null===(t=o.inputs)||void 0===t?void 0:t.map((e,t)=>(0,r.jsx)("input",{type:"text",placeholder:e.name,value:u[t],onChange:e=>c({args:u.map((a,r)=>t==r?e.target.value:a)}),className:(0,d.Z)("bg-white dark:bg-transparent border-slate-400  focus:border-blue-400 ","w-full h-14 text-right pr-4 font-bold text-sm border focus:border-2  rounded-md outline-none")},"input_".concat(t))),(0,r.jsx)(s.v,{tx:"Write",config:{abi:a,address:n,functionName:l,args:convertArgs(u,o.inputs)},className:"!mt-0 btn-primary max-w-[100px] flex items-center justify-center gap-4"})]})}function ClaimYieldsForBuyPool(e){let{vc:t}=e,{data:a}=(0,c.D2)({abi:l.aT,address:t.ptyPoolBelowAddress,functionName:"claimableYields"}),n=t.ptyPoolBelowAddress&&a||0n,[{address:i},o]=(0,x.Z)({address:""});return(0,r.jsxs)(Expandable,{tit:"ClaimYields for Buy Low Pool",children:[(0,r.jsxs)("span",{children:["Yields: ",(0,A.d)(n)]}),(0,r.jsx)("input",{type:"text",placeholder:"recipient",value:i,onChange:e=>o({address:e.target.value}),className:(0,d.Z)("bg-white dark:bg-transparent border-slate-400  focus:border-blue-400 ","w-full h-14 text-right pr-4 font-bold text-sm border focus:border-2  rounded-md outline-none")}),(0,r.jsx)(s.v,{tx:"Write",disabled:!t.ptyPoolBelowAddress||n<=0n,config:{abi:l.aT,address:t.ptyPoolBelowAddress,functionName:"claimYields",args:[i]},className:"!mt-0 btn-primary max-w-[100px] flex items-center justify-center gap-4"})]})}function SetTester(e){let{vc:t}=e,{data:a}=(0,c.D2)({abi:l.Og,address:t.assetTokenFeed,functionName:"getTestersCount"}),{data:n}=(0,c.D2)({abi:l.Og,address:t.assetTokenFeed,functionName:"owner"}),i=a||0n,{data:o}=(0,c.uX)({contracts:Array.from(Array(parseInt(i.toString()))).map((e,a)=>({abi:l.Og,address:t.assetTokenFeed,functionName:"getTester",args:[BigInt(a)]}))}),u=(null==o?void 0:o.map(e=>e.result))||[],[{address:p},m]=(0,x.Z)({address:""});return(0,r.jsxs)(Expandable,{tit:"Set tester",children:[(0,r.jsxs)("div",{children:["Owner: ",n]}),(0,r.jsxs)("div",{children:["Tester Count: ",i.toString()]}),(0,r.jsx)("div",{children:"Testers"}),u.map(e=>(0,r.jsx)("div",{children:e},e)),(0,r.jsx)("input",{type:"text",placeholder:"recipient",value:p,onChange:e=>m({address:e.target.value}),className:(0,d.Z)("bg-white dark:bg-transparent border-slate-400  focus:border-blue-400 ","w-full h-14 text-right pr-4 font-bold text-sm border focus:border-2  rounded-md outline-none")}),(0,r.jsx)(s.v,{tx:"Write",disabled:!p,config:{abi:l.Og,address:t.assetTokenFeed,functionName:"setTester",args:[p,!0]},className:"!mt-0 btn-primary max-w-[100px] flex items-center justify-center gap-4"})]})}let k=[{label:"赎回手续费",value:"C"}];function AdminPage(){let e=(0,u.p)(),t=o.iK[e]||[],a=o.VQ[e]||[],s=i.Fw[e]||[],{chain:c}=(0,y.m)(),d=(0,p.useMemo)(()=>{let e=t.map(e=>({label:e.assetTokenSymbol,value:e.vault,data:e,type:"L-Vault"})),r=a.map(e=>({label:e.assetTokenSymbol,value:e.vault,data:e,type:"P-Vault"})),n=s.map(e=>({label:e.assetSymbol,value:e.vault,data:e,type:"B-Vault"}));return[...e,...r,...n].map(e=>({...e,label:"".concat(e.label,"(").concat(e.type,")")}))},[t,a,s]),[{current:m},b]=(0,x.Z)({current:d[0]});return(0,r.jsx)(n.E,{children:(0,r.jsx)("div",{className:"w-full flex",children:(0,r.jsxs)("div",{className:"flex flex-col gap-2 w-full max-w-[840px] mx-auto px-5",children:[(0,r.jsx)(f.ZP,{classNames:j,defaultValue:d[0],options:d,onChange:e=>e&&b({current:e})}),"L-Vault"==m.type&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(UpdateVaultParams,{vault:m.data.vault,paramList:w,protocoSettingAddress:o.e_[e]}),(0,r.jsx)(UpdateVaultPrice,{vc:m.data}),["pauseMint","unpauseMint","pauseRedeem","unpauseRedeem","pauseUsbToMarginTokens","unpauseUsbToMarginTokens"].map(e=>(0,r.jsx)(GeneralAction,{functionName:e,abi:l.WW,address:m.data.vault},"l-vault-".concat(e))),(0,r.jsx)(GeneralAction,{tit:"Owner transfer",abi:l.EF,functionName:"transferOwnership",address:o.Vq[e]}),(0,r.jsx)(ClaimYieldsForBuyPool,{vc:m.data}),(null==c?void 0:c.testnet)&&(0,r.jsx)(SetTester,{vc:m.data})]}),"P-Vault"==m.type&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(UpdateVaultParams,{vault:m.data.vault,paramList:k,protocoSettingAddress:o.e_[e]}),["configureBlastYieldsAndGas","configureBlastPoints"].map(e=>(0,r.jsx)(GeneralAction,{abi:l.a4,functionName:e,address:m.data.vault},"p-vault-".concat(e)))]}),"B-Vault"==m.type&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(UpdateVaultParams,{vault:m.data.vault,paramList:N,protocoSettingAddress:m.data.protocolSettingsAddress}),["pauseDeposit","unpauseDeposit","pauseSwap","unpauseSwap","pauseClaimBribes","unpauseClaimBribes","updateStakingPool","rescueFromStakingPool"].map(e=>(0,r.jsx)(GeneralAction,{abi:l.j5,functionName:e,address:m.data.vault},"b-vault-".concat(e))),(0,r.jsx)(GeneralAction,{tit:"transferOwnership",abi:l.RR,functionName:"transferOwnership",address:m.data.protocolAddress})]})]})})})}},99548:function(e,t,a){"use strict";a.d(t,{v:function(){return ApproveAndTx}});var r=a(31113),s=a(19757),n=a(26361),l=a(64103),i=a(47259),o=a(58714),u=a(41440),c=a(41774),d=a(48914);let p={},useApproves=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10000000000n*10n**18n,{address:r,chainId:m}=(0,u.m)(),b=(0,c.t)(),{data:f}=(0,d.p)(),[x,v]=(0,l.useState)(!1),g=(0,l.useMemo)(()=>Object.keys(e).filter(e=>e!==s.K8),[e]),[h,A]=(0,l.useState)(t&&p[t]||{}),updateAllownce=(e,a)=>{t&&(p[t]={...p[t]||{},[e]:a},A(t=>({...t,[e]:a})))},y=(0,c.t)();(0,l.useEffect)(()=>{r&&t&&b&&m&&g.forEach(e=>{b.readContract({abi:o.Wo,address:e,functionName:"allowance",args:[r,t]}).then(t=>updateAllownce(e,t||0n)).catch(console.error)})},[g,m,r]);let[j,w]=(0,l.useState)(!1),N=(0,l.useMemo)(()=>g.filter(t=>(0,n.ok)(e,t)>0n&&(0,n.ok)(e,t)>(0,n.ok)(h,t)),[e,g,h]),approve=async()=>{if(0!=N.length&&t)try{w(!0),v(!1);for(let r=0;r<N.length;r++){let s=N[r],n=!1===a?e[s]:a,l=await (null==f?void 0:f.writeContract({abi:o.Wo,address:s,functionName:"approve",args:[t,n]}));l&&await (null==y?void 0:y.waitForTransactionReceipt({hash:l})),updateAllownce(s,n)}i.A.success("Approve success"),w(!1),v(!0)}catch(e){i.A.error((0,n.az)(e)),w(!1),v(!1)}};return{approve,loading:j,shouldApprove:N.length>0,isSuccess:x}};var m=a(78354),b=a(88501),f=a(36762);function ApproveAndTx(e){let{className:t,txType:a="btn-primary",tx:s,busyShowTxet:n=!0,approves:i,spender:o,requestAmount:u,config:c,toast:d=!0,disabled:p,onTxSuccess:x,onApproveSuccess:v}=e,{write:g,isDisabled:h,isLoading:A}=(0,m.R)(c,{onSuccess:()=>x&&x(),autoToast:d}),y=p||h||A||!1===c.enabled,{approve:j,shouldApprove:w,loading:N,isSuccess:k}=useApproves(i||{},o,u),C=(0,l.useRef)();return(C.current=v,(0,l.useEffect)(()=>{C.current&&k&&C.current()},[k]),w)?(0,r.jsxs)("button",{className:(0,b.m)(a,"flex items-center justify-center gap-4",t),onClick:j,disabled:p||!j||N,children:[N&&(0,r.jsx)(f.$,{}),"Approve"]}):(0,r.jsxs)("button",{className:(0,b.m)(a,"flex items-center justify-center gap-4",t),onClick:()=>g(),disabled:y,children:[A&&(0,r.jsx)(f.$,{}),(n||!A)&&s]})}},44939:function(e,t,a){"use strict";a.d(t,{E:function(){return PageWrap}});var r=a(31113);a(64103);var s=a(26361),n=a(69708),l=a(12045);function PageWrap(e){let{children:t,className:a}=e,i=(0,l.l)(e=>e.theme),o=(0,n.usePathname)();return(0,r.jsx)("div",{className:(0,s.cn)("min-h-[calc(100vh+1px)] h-auto pt-[90px] pb-6",a),style:{backgroundSize:"contain",background:"light"==i?"#eeeeee":"/"==o?"url(bg_home.svg) center bottom no-repeat,linear-gradient(105.67deg, #02050E 14.41%, #1D2F23 98.84%)":"linear-gradient(105.67deg, #02050E 14.41%, #1D2F23 98.84%)"},children:t})}},36762:function(e,t,a){"use strict";a.d(t,{$:function(){return Spinner}});var r=a(31113),s=a(33501);let Spinner=e=>{let{className:t}=e;return(0,r.jsxs)("svg",{fill:"none",className:(0,s.Z)(t,"animate-spin h-5 w-5 2-ml-1 2mr-3"),viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}},87031:function(e,t,a){"use strict";a.d(t,{Fw:function(){return s}});var r=a(73216);let s={[r.BG.id]:[{vault:"0x2e2DDCa8caA76Cc17f72275A7c61EAa3810CAA3c",asset:"0x28fb8512e1cac919e10694bD5CCa8d88f36Ab202",assetSymbol:"iRED",pToken:"0x",pTokenSymbol:"piRED",yToken:"0x",yTokenSymbol:"yiRED",protocolAddress:"0x28fb8512e1cac919e10694bD5CCa8d88f36Ab202",protocolSettingsAddress:"0x853CeB293aaeAa8c378AA1357685b05A74c6B068",vaultQueryAddress:"0xa84AF09c38a1Cd5F714303C138A30ba66D051F7f"}]}},78354:function(e,t,a){"use strict";a.d(t,{R:function(){return useWrapContractWrite}});var r=a(26361),s=a(64103),n=a(47259),l=a(41774),i=a(48914),o=a(15506);function useWrapContractWrite(e,t){let{autoToast:a=!0,onSuccess:u}=t||{},[c,d]=(0,s.useState)(!1),[p,m]=(0,s.useState)(!1),b=(0,l.t)(),{data:f}=(0,i.p)(),x=!b||!f||!f.account||c||!e,v=(0,o.hp)(),write=async()=>{if(!x){d(!0),m(!1);try{let t="function"==typeof e?await e():e,{request:r}=await b.simulateContract({account:f.account,...t}),s=await f.writeContract(r),l=await b.waitForTransactionReceipt({hash:s});if("success"!==l.status)throw"Transaction reverted";m(!0),u&&u(),a&&n.A.success("Transaction success"),v.update()}catch(e){a&&n.A.error((0,r.az)(e))}d(!1)}};return{write,isDisabled:x,isLoading:c,isSuccess:p}}}},function(e){e.O(0,[4881,7495,7622,3119,8410,5631,966,7115,7093,604,1744],function(){return e(e.s=32004)}),_N_E=e.O()}]);